<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Core Java Concepts</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ANGULAR -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-sanitize.min.js"></script>

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

    <!-- PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <!-- YOUR CSS -->
    <link rel="stylesheet" href="style04.css">
</head>

<body ng-app="javaApp" ng-controller="TopicController">

<!-- NAVBAR -->
<nav class="navbar">
    <button onclick="toggleSidebar()" id="toggleSidebar" class="btn sidebar-toggle-btn btn-sm">
        Show topic
    </button>

    <button onclick="downloadPDF()" class="btn btn-warning btn-sm ms-2">
        Download PDF
    </button>

    <span class="nav-title"><strong>Core Java Concepts</strong></span>
</nav>

<!-- SEARCH -->
<input type="search"
       class="form-control"
       style="margin:10px"
       placeholder="Search topic..."
       ng-model="searchText"
       ng-keyup="searchTopics()">

<div class="sidebar-container">

    <!-- SIDEBAR -->
    <div class="sidebar" id="main-sidebar">
        <a ng-repeat="t in topics"
           ng-click="showTopic(t.topic_key)"
           ng-class="{active: currentTopic && currentTopic.topic_key === t.topic_key}">
            {{ t.title }}
        </a>
    </div>

    <!-- CONTENT -->
    <div class="content">

        <div class="topic-content visible" ng-if="currentTopic">
            <h2>{{ currentTopic.title }}</h2>
            <div ng-bind-html="currentTopic.content"></div>
        </div>

        <div class="topic-content visible" ng-if="!currentTopic">
            <h3 class="text-muted">Select a topic from the sidebar</h3>
        </div>

    </div>
</div>

<!-- FOOTER -->
<div class="Footer">
    <footer>
        <p>&copy; UmeshMenariya</p>
        <address>
            <a href="#" style="color:white">umesh.menariya@somaiya.edu</a><br>
            <a href="#" style="color:white">+91 8079068642</a>
        </address>
    </footer>
</div>

<!-- ANGULAR SCRIPT -->
<script>
var app = angular.module("javaApp", ['ngSanitize']);

app.controller("TopicController", function ($scope, $http) {

    $scope.topics = [];
    $scope.currentTopic = null;
    $scope.searchText = "";

    // Load topics
    $scope.loadTopics = function () {
        $http.get("http://localhost/core-java-api/api/getTopics.php")
            .then(res => $scope.topics = res.data);
    };

    $scope.loadTopics();

    // Show topic
    $scope.showTopic = function (key) {
        $http.get("http://localhost/core-java-api/api/getTopicByKey.php?key=" + key)
            .then(res => $scope.currentTopic = res.data);
    };

    // Search
    $scope.searchTopics = function () {
        if ($scope.searchText.trim() === "") {
            $scope.loadTopics();
            return;
        }

        $http.get(
            "http://localhost/core-java-api/api/searchTopics.php?q=" +
            encodeURIComponent($scope.searchText)
        ).then(res => {
            $scope.topics = res.data;
        });
    };
});
</script>

<!-- SIDEBAR TOGGLE -->
<script>
function toggleSidebar() {
    const sidebar = document.getElementById("main-sidebar");
    const btn = document.getElementById("toggleSidebar");
    const hidden = sidebar.classList.toggle("hidden");
    btn.textContent = hidden ? "Show topic" : "Hide topic";
}
</script>

<!-- PDF DOWNLOAD -->
<script>
function downloadPDF() {
    const content = document.querySelector(".content");
    html2pdf().from(content).save("CoreJava.pdf");
}
</script>

</body>
</html>
